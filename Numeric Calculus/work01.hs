{-
    - Problema aplicado no mínimo 15 pontos,
    - Implementar o ajuste linear
    - Calcular R²
    - Plotar em um mesmo plano os pontos e a curva.
-}

n  = 96
x  = [61500,67500,75000,75000,76000,77000,80000,81000,81000,85000,90000,
      90000,90000,94000,94000,95000,102000,104000,106000,110000,115000,115000,
      120000,121000,124000,125000,125000,126000,127000,130000,130000,135000,
      135000,135000,135000,140000,140000,140000,140000,145000,145000,148000,
      151000,155000,163000,165000,165000,165000,170000,170000,170000,170000,
      170000,174000,175000,178000,189000,190000,191000,194000,195000,200000,
      200000,200000,200000,200000,200000,200000,200000,208000,210000,214000,
      225000,225000,231000,240000,240000,240000,240000,240000,241000,244500,
      250000,262000,270000,270000,275000,289000,295000,300000,300000,303000,
      304000,310000,315000,325000]

y  = [6656,6864,4992,7280,6656,4576,4992,6656,4784,7072,6240,6240,
      4576,8736,5200,7904,9568,7904,6656,7072,5824,7904,11440,12064,
      8528,7904,8500,6240,8944,9776,7696,8320,7280,7488,8736,9152,9360,
      9568,10816,8320,11232,8320,7904,7488,11024,8528,9152,13312,8500,
      12688,8736,9568,11232,10400,9152,11856,12272,8320,12064,11232,11024,
      10608,10000,12272,9360,8320,13312,10400,12480,10400,11232,8528,10400,
      12480,12896,11648,11648,12064,11024,10192,9152,11232,12500,10192,12480,
      12896,13312,11648,11232,12480,12896,12272,12272,12480,12896,12480]

-- Retorna o quadrado dos valores na lista X.
xi² :: (Floating a ) => [a] -> [a]
xi² xi =
    [x ^ 2 | x <- xi]

-- Retorna o quadrado dos valores na lista Y.
yi² :: (Floating a) => [a] -> [a]
yi² yi =
    [y ^ 2 | y <- yi]

somX   = sum(x)                              -- Soma dos valores na lista X.
somY   = sum(y)                              -- Soma dos valores na lista Y.
somX²  = sum (xi² x)                         -- Soma dos quadrados de X.
somY²  = sum (yi² y)                         -- Soma dos quadrados de Y.
somXY  = sum (zipWith (\x y -> x * y) x y)   -- Multiplicação dos valores de X, Y

-- Fórmula de a
a   = (n * somXY - (somX * somY)) / ((n * somX²) - (somX ^ 2))

-- Fórmula de b
b   = (somY - (a * somX)) / n

-- Fórmula de r²
r²  = ((somXY - ((somX * somY) / n)) ^ 2) / ( (somX² - ((somX) ^ 2) / n) * (somY² - ((somY ^ 2) / n)))

